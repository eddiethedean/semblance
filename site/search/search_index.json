{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"],"fields":{"title":{"boost":1000.0},"text":{"boost":1.0},"tags":{"boost":1000000.0}}},"docs":[{"location":"","title":"Semblance","text":"<p>Schema-driven REST API simulation with FastAPI, Pydantic, and Polyfactory.</p> <p>Semblance lets you define API behavior declaratively using schemas alone. Input models, output models, and relationships between them fully determine API responses \u2014 no endpoint logic required.</p> <p>A semblance is the appearance or form of something \u2014 not the thing itself. Semblance creates APIs that look and behave real enough to test, prototype, and integrate against.</p>"},{"location":"#quick-start","title":"Quick Start","text":"<pre><code>pip install semblance\n</code></pre> <p>Create <code>app.py</code>:</p> <pre><code>from datetime import date, datetime\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import DateRangeFrom, FromInput, SemblanceAPI\n\n\nclass UserQuery(BaseModel):\n    name: str = \"alice\"\n    start_date: date = date(2020, 1, 1)\n    end_date: date = date(2025, 12, 31)\n\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    created_at: Annotated[\n        datetime,\n        DateRangeFrom(\"start_date\", \"end_date\"),\n    ]\n\n\napi = SemblanceAPI()\n\n\n@api.get(\"/users\", input=UserQuery, output=list[User])\ndef users():\n    pass\n\n\napp = api.as_fastapi()\n</code></pre> <p>Run:</p> <pre><code>semblance run app:api --port 8000\n# or\nuvicorn app:app --reload\n</code></pre> <p>Try:</p> <pre><code>curl \"http://127.0.0.1:8000/users?name=alice&amp;start_date=2024-01-01&amp;end_date=2024-12-31\"\n</code></pre>"},{"location":"#features","title":"Features","text":"<ul> <li>Zero endpoint logic \u2014 schemas drive behavior</li> <li>Schema-driven \u2014 input/output models and links define responses</li> <li>Deterministic seeding \u2014 reproducible responses for tests</li> <li>FastAPI-native \u2014 full OpenAPI, validation, async</li> <li>Extensible \u2014 custom link types via plugins</li> </ul>"},{"location":"#next-steps","title":"Next Steps","text":"<ul> <li>Getting Started \u2014 full walkthrough</li> <li>Input and Output Binding \u2014 FromInput, DateRangeFrom, and more</li> <li>Examples \u2014 runnable examples</li> <li>API Reference \u2014 module reference</li> </ul>"},{"location":"publishing/","title":"Publishing to PyPI","text":""},{"location":"publishing/#prerequisites","title":"Prerequisites","text":"<ol> <li>PyPI account \u2013 Register if needed.</li> <li>API token (recommended) \u2013 PyPI \u2192 Account settings \u2192 API tokens. Create a token with scope \u201cEntire account\u201d or \u201cProject: semblance\u201d.</li> </ol>"},{"location":"publishing/#build","title":"Build","text":"<p>From the project root:</p> <pre><code>pip install build\npython -m build\n</code></pre> <p>Artifacts are created in <code>dist/</code>.</p>"},{"location":"publishing/#publish","title":"Publish","text":""},{"location":"publishing/#option-a-api-token-recommended","title":"Option A: API token (recommended)","text":"<pre><code>pip install twine\ntwine upload dist/*\n</code></pre> <p>When prompted: - Username: <code>__token__</code> - Password: your PyPI API token (starts with <code>pypi-</code>)</p> <p>Or non-interactive:</p> <pre><code>TWINE_USERNAME=__token__ TWINE_PASSWORD=pypi-YOUR_TOKEN twine upload dist/*\n</code></pre>"},{"location":"publishing/#option-b-test-pypi-first","title":"Option B: Test PyPI first","text":"<p>To try the upload to Test PyPI without publishing to the real index:</p> <pre><code>twine upload --repository testpypi dist/*\n</code></pre> <p>Install from Test PyPI: <code>pip install -i https://test.pypi.org/simple/ semblance</code></p>"},{"location":"publishing/#option-c-trusted-publishing-no-token-in-env","title":"Option C: Trusted publishing (no token in env)","text":"<p>On GitHub Actions you can use Trusted Publishing so no token is stored in the repo.</p>"},{"location":"publishing/#after-publishing","title":"After publishing","text":"<ul> <li>PyPI project: https://pypi.org/project/semblance/</li> <li>Install: <code>pip install semblance</code></li> </ul>"},{"location":"publishing/#version-bumps","title":"Version bumps","text":"<p>Before each release, update <code>version</code> in <code>pyproject.toml</code>, then rebuild and upload. You cannot reuse a version number once it has been published.</p>"},{"location":"roadmap/","title":"Roadmap","text":""},{"location":"roadmap/#phase-1-mvp-foundations","title":"Phase 1 \u2014 MVP (Foundations) \u2713","text":"<ul> <li>SemblanceAPI core</li> <li>GET endpoints</li> <li>Query parameter inputs</li> <li>Single &amp; list outputs</li> <li>FromInput binding</li> <li>DateRangeFrom constraint</li> <li>Polyfactory integration</li> <li>FastAPI app export</li> <li>Basic pytest client</li> </ul>"},{"location":"roadmap/#phase-2-practical-expansion","title":"Phase 2 \u2014 Practical Expansion \u2713","text":"<ul> <li>POST endpoints with body models</li> <li>Path parameter support (GET and POST)</li> <li>Pagination helpers (PageParams, PaginatedResponse)</li> <li>Deterministic seeding (SemblanceAPI(seed=), seed_from=)</li> <li>Error response simulation (error_rate, error_codes)</li> <li>Response count / limit constraints (list_count=, list_count=\"field\")</li> </ul>"},{"location":"roadmap/#phase-3-advanced-simulation","title":"Phase 3 \u2014 Advanced Simulation \u2713","text":"<ul> <li>Conditional dependencies (WhenInput)</li> <li>Cross-field constraints (ComputedFrom)</li> <li>Collection filtering constraints (filter_by=)</li> <li>Nested model linking</li> <li>Optional stateful mode (SemblanceAPI(stateful=True))</li> <li>Latency &amp; jitter simulation (latency_ms=, jitter_ms=)</li> </ul>"},{"location":"roadmap/#phase-4-ecosystem-polish","title":"Phase 4 \u2014 Ecosystem &amp; Polish \u2713","text":"<ul> <li>Plugin system for custom links</li> <li>OpenAPI schema annotations (summary, description, tags)</li> <li>CLI runner (<code>semblance run</code>, <code>semblance export</code>)</li> <li>Frontend mock export (OpenAPI + fixtures)</li> <li>Documentation site (MkDocs)</li> <li>Example galleries</li> </ul>"},{"location":"semblance_planning_and_roadmap/","title":"Semblance --- Schema-Driven API Simulation","text":""},{"location":"semblance_planning_and_roadmap/#1-project-overview","title":"1. Project Overview","text":"<p>Semblance is a Python package for building fast, realistic REST API simulators using FastAPI, Pydantic, and Polyfactory.</p> <p>Semblance allows developers to define API behavior declaratively using schemas alone. Input models, output models, and relationships between them fully determine API responses, with no endpoint logic required.</p> <p>A semblance is the appearance or form of something --- not the thing itself.\\ Semblance creates APIs that look and behave real enough to test, prototype, and integrate against.</p>"},{"location":"semblance_planning_and_roadmap/#2-core-goals","title":"2. Core Goals","text":"<ul> <li>Zero endpoint logic</li> <li>Schema-driven behavior</li> <li>Deterministic but randomized responses</li> <li>FastAPI-native developer experience</li> <li>First-class testing support</li> <li>Extensible dependency/constraint system</li> </ul> <p>Non-goals: - Business logic execution - Database simulation - Full backend replacement</p>"},{"location":"semblance_planning_and_roadmap/#3-core-concepts","title":"3. Core Concepts","text":""},{"location":"semblance_planning_and_roadmap/#31-schema-as-behavior","title":"3.1 Schema as Behavior","text":"<p>Semblance treats Pydantic models as executable contracts.</p> <ul> <li>Input models describe requests</li> <li>Output models describe responses</li> <li>Metadata describes relationships</li> </ul> <p>No imperative glue code is required.</p>"},{"location":"semblance_planning_and_roadmap/#32-model-embedded-dependencies","title":"3.2 Model-Embedded Dependencies","text":"<p>Relationships are declared inside output models using <code>typing.Annotated</code> metadata.</p> <pre><code>@dataclass(frozen=True)\nclass FromInput:\n    field: str\n\n@dataclass(frozen=True)\nclass DateRangeFrom:\n    start: str\n    end: str\n</code></pre> <pre><code>class UserQuery(BaseModel):\n    name: str\n    start_date: date\n    end_date: date\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    created_at: Annotated[\n        datetime,\n        DateRangeFrom(\"start_date\", \"end_date\")\n    ]\n</code></pre> <p>Dependencies live with the fields they affect.</p>"},{"location":"semblance_planning_and_roadmap/#4-high-level-architecture","title":"4. High-Level Architecture","text":""},{"location":"semblance_planning_and_roadmap/#request-lifecycle","title":"Request Lifecycle","text":"<ol> <li>Request received by FastAPI</li> <li>Input model validated</li> <li>Output model inspected for dependency metadata</li> <li>Dependency resolver builds generation strategies</li> <li>Polyfactory generates response objects</li> <li>Response returned</li> </ol>"},{"location":"semblance_planning_and_roadmap/#key-components","title":"Key Components","text":"<ul> <li><code>semblance.api</code> --- endpoint registration &amp; app creation</li> <li><code>semblance.links</code> --- dependency metadata &amp; DSL (FromInput, DateRangeFrom)</li> <li><code>semblance.resolver</code> --- constraint resolution engine</li> <li><code>semblance.factory</code> --- Polyfactory integration layer</li> <li><code>semblance.pagination</code> --- PageParams, PaginatedResponse</li> <li><code>semblance.testing</code> --- test_client for pytest</li> </ul>"},{"location":"semblance_planning_and_roadmap/#5-public-api","title":"5. Public API","text":"<pre><code>from semblance import SemblanceAPI\n\napi = SemblanceAPI()\n\n@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=list[User],\n)\ndef users():\n    pass\n\napp = api.as_fastapi()\n</code></pre> <p>Endpoint bodies are optional and ignored.</p>"},{"location":"semblance_planning_and_roadmap/#6-dependency-resolution-model","title":"6. Dependency Resolution Model","text":"<ul> <li>Dependencies resolve to generation strategies, not values</li> <li>Strategies are translated into Polyfactory overrides</li> <li>Supports:<ul> <li>Static bindings</li> <li>Callable generators</li> <li>Collection-wide constraints</li> </ul> </li> </ul> <p>Example resolved override:</p> <pre><code>{\n    \"name\": input.name,\n    \"created_at\": lambda: random_datetime(start, end)\n}\n</code></pre>"},{"location":"semblance_planning_and_roadmap/#7-testing-tooling","title":"7. Testing &amp; Tooling","text":""},{"location":"semblance_planning_and_roadmap/#pytest-harness","title":"Pytest Harness","text":"<pre><code>from semblance import test_client\n\napp = api.as_fastapi()\nclient = test_client(app)\nr = client.get(\"/users?name=alice\")\nassert r.status_code == 200\n</code></pre>"},{"location":"semblance_planning_and_roadmap/#test-coverage","title":"Test Coverage","text":"<ul> <li><code>test_api</code> --- SemblanceAPI, GET endpoints, FastAPI app export</li> <li><code>test_factory</code> --- build_response, pagination, seed determinism, edge cases</li> <li><code>test_resolver</code> --- resolve_overrides, DateRangeFrom, _to_datetime, get_output_model_for_type</li> <li><code>test_links</code> --- FromInput, DateRangeFrom, get_field_metadata</li> <li><code>test_phase2</code> --- POST, path params, pagination, seeding, error simulation</li> <li><code>test_edge_cases</code> --- validation, duplicate paths, FromInput with None</li> </ul> <p>Supports: - Contract testing - Snapshot testing - Frontend-backend integration tests - pytest-cov for coverage reporting (95%+)</p>"},{"location":"semblance_planning_and_roadmap/#8-roadmap","title":"8. Roadmap","text":""},{"location":"semblance_planning_and_roadmap/#recent-updates","title":"Recent Updates","text":"<ul> <li>Bug fixes: unused TypeVar removal, pagination limit/offset coercion robustness, null-safety in _get_paginated_inner</li> <li>Test coverage expanded to 95%+ with 46 tests across api, factory, resolver, links, phase2, and edge cases</li> <li>pytest-cov added to dev dependencies</li> </ul>"},{"location":"semblance_planning_and_roadmap/#phase-1-mvp-foundations","title":"Phase 1 --- MVP (Foundations)","text":"<p>Goal: Usable, minimal, stable</p> <ul> <li>[x] SemblanceAPI core</li> <li>[x] GET endpoints</li> <li>[x] Query parameter inputs</li> <li>[x] Single &amp; list outputs</li> <li>[x] <code>FromInput</code> binding</li> <li>[x] <code>DateRangeFrom</code> constraint</li> <li>[x] Polyfactory integration</li> <li>[x] FastAPI app export</li> <li>[x] Basic pytest client</li> </ul>"},{"location":"semblance_planning_and_roadmap/#phase-2-practical-expansion","title":"Phase 2 --- Practical Expansion","text":"<p>Goal: Real-world testing usefulness</p> <ul> <li>[x] POST endpoints with body models</li> <li>[x] Path parameter support (GET and POST)</li> <li>[x] Pagination helpers (PageParams, PaginatedResponse)</li> <li>[x] Deterministic seeding (SemblanceAPI(seed=), seed_from=)</li> <li>[x] Error response simulation (error_rate, error_codes)</li> <li>[x] Response count / limit constraints (list_count=, list_count=\"field\")</li> </ul>"},{"location":"semblance_planning_and_roadmap/#phase-3-advanced-simulation","title":"Phase 3 --- Advanced Simulation","text":"<p>Goal: Expressive behavior modeling</p> <ul> <li>[x] Conditional dependencies (WhenInput)</li> <li>[x] Cross-field constraints (ComputedFrom)</li> <li>[x] Collection filtering constraints (filter_by=)</li> <li>[x] Nested model linking</li> <li>[x] Optional stateful mode (SemblanceAPI(stateful=True))</li> <li>[x] Latency &amp; jitter simulation (latency_ms=, jitter_ms=)</li> </ul>"},{"location":"semblance_planning_and_roadmap/#phase-4-ecosystem-polish","title":"Phase 4 --- Ecosystem &amp; Polish","text":"<p>Goal: Adoption and extensibility</p> <ul> <li>[ ] Plugin system for custom links</li> <li>[ ] OpenAPI schema annotations</li> <li>[ ] CLI runner</li> <li>[ ] Frontend mock export</li> <li>[ ] Documentation site</li> <li>[ ] Example galleries</li> </ul>"},{"location":"semblance_planning_and_roadmap/#9-risks-design-guardrails","title":"9. Risks &amp; Design Guardrails","text":"<ul> <li>Avoid model-to-model imports to prevent coupling</li> <li>Keep dependency DSL explicit and inspectable</li> <li>Prefer composition over magic</li> <li>Maintain FastAPI and Pydantic idioms</li> </ul>"},{"location":"semblance_planning_and_roadmap/#10-summary","title":"10. Summary","text":"<p>Semblance provides a clean, declarative way to create realistic API simulations using schemas alone. By embedding behavioral constraints directly into Pydantic models, Semblance enables fast, reliable testing and prototyping without sacrificing correctness or developer ergonomics.</p>"},{"location":"api/","title":"API Reference","text":""},{"location":"api/#core","title":"Core","text":""},{"location":"api/#semblanceapi","title":"SemblanceAPI","text":"<p><code>from semblance import SemblanceAPI</code></p> <p>Main API builder. Register endpoints with input/output models.</p> <pre><code>api = SemblanceAPI(seed=None, stateful=False)\napi.get(path, *, input, output, ...)\napi.post(path, *, input, output, ...)\napp = api.as_fastapi()\n</code></pre>"},{"location":"api/#links","title":"Links","text":"<p><code>from semblance import FromInput, DateRangeFrom, WhenInput, ComputedFrom</code></p> <ul> <li>FromInput(field) \u2014 bind output field to input field by name</li> <li>DateRangeFrom(start, end) \u2014 datetime in range defined by input date fields</li> <li>WhenInput(cond_field, cond_value, then_link) \u2014 apply link when condition matches</li> <li>ComputedFrom(fields, fn) \u2014 compute field from other output fields</li> </ul>"},{"location":"api/#pagination","title":"Pagination","text":"<p><code>from semblance import PageParams, PaginatedResponse</code></p> <ul> <li>PageParams \u2014 limit, offset query params</li> <li>PaginatedResponse[T] \u2014 items, total, limit, offset</li> </ul>"},{"location":"api/#plugins","title":"Plugins","text":"<p><code>from semblance import register_link, LinkProtocol</code></p> <ul> <li>register_link(LinkClass) \u2014 register custom link type</li> <li>LinkProtocol \u2014 protocol for custom links (must implement <code>resolve(input_data, rng)</code>)</li> </ul>"},{"location":"api/#testing","title":"Testing","text":"<p><code>from semblance import test_client</code></p> <ul> <li>test_client(app) \u2014 httpx TestClient for FastAPI app</li> </ul>"},{"location":"api/#cli","title":"CLI","text":"<pre><code>semblance run app:api [--host HOST] [--port PORT] [--reload]\nsemblance export openapi app:api [-o FILE] [--examples]\nsemblance export fixtures app:api [-o DIR]\n</code></pre>"},{"location":"examples/","title":"Semblance Examples","text":"<p>Curated, runnable examples for common use cases.</p>"},{"location":"examples/#running-examples","title":"Running Examples","text":"<p>From the project root (with semblance installed):</p> <pre><code>semblance run examples.&lt;name&gt;.app:api --port 8000\n</code></pre> <p>Or with uvicorn:</p> <pre><code>uvicorn examples.&lt;name&gt;.app:app --reload\n</code></pre>"},{"location":"examples/#examples","title":"Examples","text":"Example Description basic Minimal GET list with FromInput, DateRangeFrom pagination PageParams, PaginatedResponse nested Nested model linking stateful POST stores items, GET returns stored list advanced WhenInput, ComputedFrom, filter_by error_simulation error_rate, error_codes plugins Custom link (FromEnv)"},{"location":"examples/advanced/","title":"Advanced Example","text":"<p>WhenInput, ComputedFrom, and filter_by.</p>"},{"location":"examples/advanced/#code","title":"Code","text":"<pre><code>\"\"\"\nAdvanced example - WhenInput, ComputedFrom, filter_by.\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import ComputedFrom, FromInput, SemblanceAPI, WhenInput\n\n\nclass UserWithStatus(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    status: Annotated[str, WhenInput(\"include_status\", True, FromInput(\"status\"))]\n\n\nclass QueryWithStatus(BaseModel):\n    name: str = \"alice\"\n    status: str = \"active\"\n    include_status: bool = False\n\n\nclass UserWithFullName(BaseModel):\n    first: Annotated[str, FromInput(\"first\")]\n    last: Annotated[str, FromInput(\"last\")]\n    full: Annotated[str, ComputedFrom((\"first\", \"last\"), lambda a, b: f\"{a} {b}\")]\n\n\nclass QueryWithNames(BaseModel):\n    first: str = \"John\"\n    last: str = \"Doe\"\n\n\napi = SemblanceAPI(seed=42)\n\n\n@api.get(\n    \"/user/status\",\n    input=QueryWithStatus,\n    output=UserWithStatus,\n    summary=\"Get user with optional status\",\n)\ndef user_status():\n    \"\"\"WhenInput: status only applied when include_status=True.\"\"\"\n    pass\n\n\n@api.get(\n    \"/user/fullname\",\n    input=QueryWithNames,\n    output=UserWithFullName,\n    summary=\"Get user with computed full name\",\n)\ndef user_fullname():\n    \"\"\"ComputedFrom: full = first + ' ' + last.\"\"\"\n    pass\n\n\n@api.get(\n    \"/users\",\n    input=QueryWithStatus,\n    output=list[UserWithStatus],\n    list_count=3,\n    filter_by=\"status\",\n    summary=\"List users filtered by status\",\n)\ndef users_filtered():\n    \"\"\"filter_by: all items match input.status.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/advanced/#run","title":"Run","text":"<pre><code>semblance run examples.advanced.app:api --port 8000\n</code></pre>"},{"location":"examples/advanced/#try","title":"Try","text":"<pre><code># WhenInput - status applied only when include_status=true\ncurl \"http://127.0.0.1:8000/user/status?name=alice&amp;include_status=true&amp;status=active\"\n\n# ComputedFrom - full name computed from first + last\ncurl \"http://127.0.0.1:8000/user/fullname?first=Jane&amp;last=Smith\"\n\n# filter_by - all list items match status (include_status=true so status comes from input)\ncurl \"http://127.0.0.1:8000/users?name=x&amp;status=active&amp;include_status=true\"\n</code></pre> <p>Example responses:</p> <pre><code>// GET /user/status?name=alice&amp;include_status=true&amp;status=active\n{\"name\": \"alice\", \"status\": \"active\"}\n\n// GET /user/fullname?first=Jane&amp;last=Smith\n{\"first\": \"Jane\", \"last\": \"Smith\", \"full\": \"Jane Smith\"}\n\n// GET /users?name=x&amp;status=active&amp;include_status=true (filter_by)\n[\n  {\"name\": \"x\", \"status\": \"active\"},\n  {\"name\": \"x\", \"status\": \"active\"},\n  {\"name\": \"x\", \"status\": \"active\"}\n]\n</code></pre>"},{"location":"examples/advanced/#concepts","title":"Concepts","text":"<ul> <li>WhenInput(cond, val, link) \u2013 apply link only when cond matches</li> <li>ComputedFrom(fields, fn) \u2013 compute field from other output fields</li> <li>filter_by \u2013 filter list items to those matching input field value</li> </ul>"},{"location":"examples/basic/","title":"Basic Example","text":"<p>Minimal Semblance API with a single GET list endpoint.</p>"},{"location":"examples/basic/#code","title":"Code","text":"<pre><code>\"\"\"\nBasic Semblance API - minimal GET list endpoint.\n\"\"\"\n\nfrom datetime import date, datetime\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import DateRangeFrom, FromInput, SemblanceAPI\n\n\nclass UserQuery(BaseModel):\n    \"\"\"GET query params for user list.\"\"\"\n\n    name: str = \"alice\"\n    start_date: date = date(2020, 1, 1)\n    end_date: date = date(2025, 12, 31)\n\n\nclass User(BaseModel):\n    \"\"\"Output model with links to input.\"\"\"\n\n    name: Annotated[str, FromInput(\"name\")]\n    created_at: Annotated[\n        datetime,\n        DateRangeFrom(\"start_date\", \"end_date\"),\n    ]\n\n\napi = SemblanceAPI(seed=42)\n\n\n@api.get(\"/users\", input=UserQuery, output=list[User], list_count=2, summary=\"List users\")\ndef users():\n    \"\"\"Returns users with name from query and created_at in date range.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/basic/#run","title":"Run","text":"<pre><code>semblance run examples.basic.app:api --port 8000\n# or\nuvicorn examples.basic.app:app --reload\n</code></pre>"},{"location":"examples/basic/#try","title":"Try","text":"<pre><code>curl \"http://127.0.0.1:8000/users?name=alice&amp;start_date=2024-01-01&amp;end_date=2024-12-31\"\n</code></pre> <p>Example response (with <code>seed=42</code>):</p> <pre><code>[\n  {\"name\": \"alice\", \"created_at\": \"2024-08-21T09:22:43.516168\"},\n  {\"name\": \"alice\", \"created_at\": \"2024-01-10T03:05:39.176702\"}\n]\n</code></pre>"},{"location":"examples/basic/#concepts","title":"Concepts","text":"<ul> <li>UserQuery \u2013 input model for query params</li> <li>User \u2013 output model with <code>FromInput</code> and <code>DateRangeFrom</code> links</li> <li>No endpoint logic \u2013 schemas drive behavior</li> </ul>"},{"location":"examples/error_simulation/","title":"Error Simulation Example","text":"<p>Simulate random API failures with <code>error_rate</code> and <code>error_codes</code>.</p>"},{"location":"examples/error_simulation/#code","title":"Code","text":"<pre><code>\"\"\"\nError simulation example - error_rate, error_codes.\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import FromInput, SemblanceAPI\n\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n\n\nclass UserQuery(BaseModel):\n    name: str = \"alice\"\n\n\napi = SemblanceAPI(seed=99)\n\n\n@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=list[User],\n    list_count=2,\n    error_rate=0.3,\n    error_codes=[404, 503],\n    summary=\"List users (may fail randomly)\",\n)\ndef users():\n    \"\"\"30% of requests return 404 or 503. Use error_rate=0 for tests.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/error_simulation/#run","title":"Run","text":"<pre><code>semblance run examples.error_simulation.app:api --port 8000\n</code></pre> <p>Or with uvicorn (from project root with <code>PYTHONPATH=.</code> or <code>pip install -e .</code>):</p> <pre><code>uvicorn examples.error_simulation.app:app --reload\n</code></pre>"},{"location":"examples/error_simulation/#try","title":"Try","text":"<pre><code># ~70% succeed, ~30% return 404 or 503 (seed=99)\ncurl \"http://127.0.0.1:8000/users?name=alice\"\n</code></pre> <p>Success response (when no error is raised):</p> <pre><code>[\n  {\"name\": \"alice\"},\n  {\"name\": \"alice\"}\n]\n</code></pre> <p>Failure response (when error_rate triggers):</p> <p><pre><code>{\"detail\": \"Simulated error\"}\n</code></pre> (Status: 404 or 503)</p>"},{"location":"examples/error_simulation/#concepts","title":"Concepts","text":"<ul> <li>error_rate \u2013 fraction of requests that fail (0.0\u20131.0)</li> <li>error_codes \u2013 list of status codes to return on failure</li> <li>seed \u2013 use for deterministic testing (same seed \u2192 same pattern)</li> <li>Use <code>error_rate=0</code> in tests for predictable success</li> </ul>"},{"location":"examples/nested/","title":"Nested Model Example","text":"<p>Output models with nested structures. Links propagate into nested models.</p>"},{"location":"examples/nested/#code","title":"Code","text":"<pre><code>\"\"\"\nNested model example - output models with nested structures.\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import FromInput, SemblanceAPI\n\n\nclass Address(BaseModel):\n    street: str = \"\"\n    city: Annotated[str, FromInput(\"city\")]\n    zip: str = \"\"\n\n\nclass UserWithAddress(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    address: Address\n\n\nclass QueryWithCity(BaseModel):\n    name: str = \"alice\"\n    city: str = \"NYC\"\n\n\napi = SemblanceAPI(seed=42)\n\n\n@api.get(\n    \"/user\",\n    input=QueryWithCity,\n    output=UserWithAddress,\n    summary=\"Get user with address\",\n)\ndef user():\n    \"\"\"Returns user with nested address; city comes from query.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/nested/#run","title":"Run","text":"<pre><code>semblance run examples.nested.app:api --port 8000\n</code></pre>"},{"location":"examples/nested/#try","title":"Try","text":"<pre><code>curl \"http://127.0.0.1:8000/user?name=foo&amp;city=Boston\"\n</code></pre> <p>Example response (with <code>seed=42</code>):</p> <pre><code>{\n  \"name\": \"foo\",\n  \"address\": {\n    \"street\": \"HbolMJUevblAbkHClEQa\",\n    \"city\": \"Boston\",\n    \"zip\": \"PKriXrefSFPLBYtCRGSE\"\n  }\n}\n</code></pre> <p><code>city</code> comes from the query; <code>street</code> and <code>zip</code> are generated by Polyfactory.</p>"},{"location":"examples/nested/#concepts","title":"Concepts","text":"<ul> <li>Nested models \u2013 <code>UserWithAddress</code> contains <code>Address</code></li> <li>Links in nested fields \u2013 <code>city</code> in <code>Address</code> uses <code>FromInput(\"city\")</code></li> <li>Resolver traverses nested models to apply links</li> </ul>"},{"location":"examples/pagination/","title":"Pagination Example","text":"<p>List endpoint with <code>PageParams</code> and <code>PaginatedResponse</code>.</p>"},{"location":"examples/pagination/#code","title":"Code","text":"<pre><code>\"\"\"\nPagination example - PageParams and PaginatedResponse.\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import FromInput, PageParams, PaginatedResponse, SemblanceAPI\n\n\nclass UserQuery(PageParams, BaseModel):\n    \"\"\"Query with limit and offset.\"\"\"\n\n    name: str = \"alice\"\n\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n\n\napi = SemblanceAPI(seed=42)\n\n\n@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=PaginatedResponse[User],\n    list_count=\"limit\",\n    summary=\"List users (paginated)\",\n)\ndef users():\n    \"\"\"Returns paginated user list.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/pagination/#run","title":"Run","text":"<pre><code>semblance run examples.pagination.app:api --port 8000\n</code></pre>"},{"location":"examples/pagination/#try","title":"Try","text":"<pre><code>curl \"http://127.0.0.1:8000/users?limit=5&amp;offset=0&amp;name=alice\"\ncurl \"http://127.0.0.1:8000/users?limit=3&amp;offset=10\"\n</code></pre> <p>Example response (<code>limit=3&amp;offset=0</code>):</p> <pre><code>{\n  \"items\": [\n    {\"name\": \"alice\"},\n    {\"name\": \"alice\"},\n    {\"name\": \"alice\"}\n  ],\n  \"total\": 3,\n  \"limit\": 3,\n  \"offset\": 0\n}\n</code></pre>"},{"location":"examples/pagination/#concepts","title":"Concepts","text":"<ul> <li>PageParams \u2013 <code>limit</code> and <code>offset</code> query params</li> <li>PaginatedResponse[T] \u2013 <code>items</code>, <code>total</code>, <code>limit</code>, <code>offset</code></li> </ul>"},{"location":"examples/plugins/","title":"Plugins Example","text":"<p>Custom link type (<code>FromEnv</code>) that reads values from environment variables.</p>"},{"location":"examples/plugins/#code","title":"Code","text":"<pre><code>\"\"\"\nPlugins example - custom link (FromEnv).\n\nSet USER_NAME env var to override the default:\n  USER_NAME=Bob semblance run examples.plugins.app:api --port 8000\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import FromInput, SemblanceAPI, register_link\n\n\nclass FromEnv:\n    \"\"\"Custom link: read value from environment variable.\"\"\"\n\n    def __init__(self, env_var: str):\n        self.env_var = env_var\n\n    def resolve(self, input_data: dict, rng):\n        import os\n\n        return os.environ.get(self.env_var)\n\n\nregister_link(FromEnv)\n\n\nclass User(BaseModel):\n    name: Annotated[str, FromEnv(\"USER_NAME\")]\n    role: Annotated[str, FromInput(\"role\")]\n\n\nclass UserQuery(BaseModel):\n    role: str = \"viewer\"\n\n\napi = SemblanceAPI(seed=42)\n\n\n@api.get(\n    \"/user\",\n    input=UserQuery,\n    output=User,\n    summary=\"Get user (name from USER_NAME env)\",\n)\ndef user():\n    \"\"\"name comes from USER_NAME env; role from query.\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/plugins/#run","title":"Run","text":"<pre><code># Default: USER_NAME not set, Polyfactory generates name\nsemblance run examples.plugins.app:api --port 8000\n\n# Override: name from env\nUSER_NAME=Bob semblance run examples.plugins.app:api --port 8000\n</code></pre>"},{"location":"examples/plugins/#try","title":"Try","text":"<pre><code># Without USER_NAME set\ncurl \"http://127.0.0.1:8000/user?role=admin\"\n# \u2192 {\"name\": \"&lt;generated&gt;\", \"role\": \"admin\"}\n\n# With USER_NAME=DocBot (before starting server)\nUSER_NAME=DocBot semblance run examples.plugins.app:api --port 8000\n# In another terminal:\ncurl \"http://127.0.0.1:8000/user?role=admin\"\n# \u2192 {\"name\": \"DocBot\", \"role\": \"admin\"}\n</code></pre> <p>Example output with <code>USER_NAME=DocBot</code>:</p> <pre><code>{\"name\": \"DocBot\", \"role\": \"admin\"}\n</code></pre> <p>Without <code>USER_NAME</code>, Polyfactory generates the name (values vary per run).</p>"},{"location":"examples/plugins/#concepts","title":"Concepts","text":"<ul> <li>register_link \u2013 register custom link class</li> <li>resolve(input_data, rng) \u2013 return override value or <code>None</code> for Polyfactory</li> <li>Use for env-based config, feature flags, or custom binding logic</li> </ul>"},{"location":"examples/stateful/","title":"Stateful Example","text":"<p>POST creates and stores items; GET list returns stored instances.</p>"},{"location":"examples/stateful/#code","title":"Code","text":"<pre><code>\"\"\"\nStateful example - POST stores items, GET returns stored list.\n\"\"\"\n\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import FromInput, SemblanceAPI\n\n\nclass CreateUser(BaseModel):\n    \"\"\"POST body for creating a user.\"\"\"\n\n    name: str = \"alice\"\n\n\nclass UserWithId(BaseModel):\n    id: str = \"\"\n    name: Annotated[str, FromInput(\"name\")]\n\n\napi = SemblanceAPI(stateful=True)\n\n\n@api.post(\"/users\", input=CreateUser, output=UserWithId, summary=\"Create user\")\ndef create_user():\n    \"\"\"Creates user and stores in state. Returns stored instance with id.\"\"\"\n    pass\n\n\n@api.get(\"/users\", input=CreateUser, output=list[UserWithId], summary=\"List users\")\ndef list_users():\n    \"\"\"Returns all stored users (stateful).\"\"\"\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"examples/stateful/#run","title":"Run","text":"<pre><code>semblance run examples.stateful.app:api --port 8000\n</code></pre>"},{"location":"examples/stateful/#try","title":"Try","text":"<pre><code># Create users\ncurl -X POST \"http://127.0.0.1:8000/users\" -H \"Content-Type: application/json\" -d '{\"name\":\"alice\"}'\ncurl -X POST \"http://127.0.0.1:8000/users\" -H \"Content-Type: application/json\" -d '{\"name\":\"bob\"}'\n\n# List stored users\ncurl \"http://127.0.0.1:8000/users?name=x\"\n</code></pre> <p>Example responses (IDs vary per run):</p> <pre><code>// POST alice\n{\"id\": \"hCnVvpUeXBVQBtxIbCrv\", \"name\": \"alice\"}\n\n// POST bob\n{\"id\": \"HCmJJfYwGIBzngQDycHu\", \"name\": \"bob\"}\n\n// GET /users\n[\n  {\"id\": \"hCnVvpUeXBVQBtxIbCrv\", \"name\": \"alice\"},\n  {\"id\": \"HCmJJfYwGIBzngQDycHu\", \"name\": \"bob\"}\n]\n</code></pre>"},{"location":"examples/stateful/#concepts","title":"Concepts","text":"<ul> <li>stateful=True \u2013 SemblanceAPI stores POST responses</li> <li>GET list \u2013 returns stored instances, not newly generated</li> <li>id \u2013 auto-generated for models with id field</li> <li>State is process-local (in-memory)</li> </ul>"},{"location":"guides/","title":"Semblance User Guides","text":"<p>Guides for building and testing schema-driven API simulators with Semblance.</p>"},{"location":"guides/#guides","title":"Guides","text":"Guide Description Getting Started Install, first API, and run Input and Output Binding FromInput, DateRangeFrom, query/body/path Advanced Links WhenInput, ComputedFrom, nested models Pagination PageParams, PaginatedResponse Simulation Options Error rate, latency, filter_by Stateful Mode POST stores, GET returns stored CLI semblance run, export openapi, export fixtures Plugins Custom link types, register_link Testing test_client, deterministic seeding, pytest"},{"location":"guides/#quick-reference","title":"Quick Reference","text":"<pre><code>from semblance import (\n    ComputedFrom,\n    DateRangeFrom,\n    FromInput,\n    PageParams,\n    PaginatedResponse,\n    SemblanceAPI,\n    WhenInput,\n    test_client,\n)\n</code></pre>"},{"location":"guides/advanced-links/","title":"Advanced Links","text":"<p>This guide covers conditional dependencies, cross-field constraints, and nested model linking.</p>"},{"location":"guides/advanced-links/#wheninput","title":"WhenInput","text":"<p>Apply a link only when an input condition is met:</p> <pre><code>from typing import Annotated\nfrom semblance import FromInput, WhenInput\n\nclass UserWithStatus(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    status: Annotated[str, WhenInput(\"include_status\", True, FromInput(\"status\"))]\n</code></pre> <p>When <code>include_status</code> is <code>True</code>, <code>status</code> is bound from input. Otherwise Polyfactory generates it.</p> <p>Example (<code>GET /user?name=x&amp;status=admin&amp;include_status=true</code>):</p> <pre><code>{\"name\": \"x\", \"status\": \"admin\"}\n</code></pre>"},{"location":"guides/advanced-links/#computedfrom","title":"ComputedFrom","text":"<p>Compute an output field from other output fields in the same model:</p> <pre><code>from typing import Annotated\nfrom semblance import ComputedFrom, FromInput\n\nclass UserWithFullName(BaseModel):\n    first: Annotated[str, FromInput(\"first\")]\n    last: Annotated[str, FromInput(\"last\")]\n    full: Annotated[str, ComputedFrom((\"first\", \"last\"), lambda a, b: f\"{a} {b}\")]\n</code></pre> <p>Dependency fields must be resolved first (e.g. via <code>FromInput</code> or other links). Semblance evaluates in dependency order.</p> <p>Example (<code>GET /user?first=Jane&amp;last=Smith</code>):</p> <pre><code>{\"first\": \"Jane\", \"last\": \"Smith\", \"full\": \"Jane Smith\"}\n</code></pre>"},{"location":"guides/advanced-links/#nested-model-linking","title":"Nested Model Linking","text":"<p>Links work inside nested models. Define a nested model with its own links:</p> <pre><code>class Address(BaseModel):\n    city: Annotated[str, FromInput(\"city\")]\n\nclass UserWithAddress(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    address: Address\n</code></pre> <p>Request <code>GET /user?name=alice&amp;city=Boston</code> \u2013 the response <code>address.city</code> will be <code>\"Boston\"</code>:</p> <pre><code>{\"name\": \"alice\", \"address\": {\"city\": \"Boston\"}}\n</code></pre>"},{"location":"guides/advanced-links/#combining-links","title":"Combining Links","text":"<p>You can mix links on different fields:</p> <pre><code>class Order(BaseModel):\n    customer: Annotated[str, FromInput(\"customer_id\")]\n    placed_at: Annotated[datetime, DateRangeFrom(\"start\", \"end\")]\n    total_display: Annotated[str, ComputedFrom((\"subtotal\",), lambda s: f\"${s:.2f}\")]\n</code></pre>"},{"location":"guides/cli/","title":"CLI","text":"<p>Semblance provides a CLI for running apps and exporting mocks for frontend integration.</p>"},{"location":"guides/cli/#run-an-app","title":"Run an App","text":"<pre><code>semblance run &lt;module&gt;:&lt;attr&gt; [--host HOST] [--port PORT] [--reload]\n</code></pre> <p>The <code>module:attr</code> path loads your app. If <code>attr</code> has an <code>as_fastapi()</code> method (e.g. a <code>SemblanceAPI</code> instance), it is called to get the FastAPI app.</p> <p>Examples:</p> <pre><code>semblance run app:api --port 8000\nsemblance run examples.basic.app:api --host 0.0.0.0 --port 8000\nsemblance run examples.basic.app:app --reload\n</code></pre>"},{"location":"guides/cli/#export-openapi-schema","title":"Export OpenAPI Schema","text":"<pre><code>semblance export openapi &lt;module&gt;:&lt;attr&gt; [-o FILE] [--examples]\n</code></pre> <ul> <li><code>-o FILE</code> \u2013 write to file (default: stdout)</li> <li><code>--examples</code> \u2013 call each endpoint and populate response examples from live responses</li> </ul> <p>Example output (truncated):</p> <pre><code>semblance export openapi examples.basic.app:api -o openapi.json\n</code></pre> <pre><code>{\n  \"openapi\": \"3.1.0\",\n  \"paths\": {\n    \"/users\": {\n      \"get\": {\n        \"summary\": \"List users\",\n        \"responses\": {\"200\": {\"description\": \"Successful response\"}}\n      }\n    }\n  }\n}\n</code></pre>"},{"location":"guides/cli/#export-fixtures","title":"Export Fixtures","text":"<pre><code>semblance export fixtures &lt;module&gt;:&lt;attr&gt; [-o DIR]\n</code></pre> <p>Calls each GET/POST endpoint and saves the JSON response to <code>{output_dir}/{route_id}_{METHOD}.json</code>. Also writes <code>openapi.json</code>.</p> <p>Example:</p> <pre><code>semblance export fixtures examples.basic.app:api -o fixtures\n# Creates: fixtures/users_GET.json, fixtures/openapi.json\n</code></pre> <p>Example <code>fixtures/users_GET.json</code> (output varies per run):</p> <pre><code>[\n  {\"name\": \"alice\", \"created_at\": \"2021-06-23T16:31:27.650961\"},\n  {\"name\": \"alice\", \"created_at\": \"2024-06-04T03:14:38.140312\"},\n  {\"name\": \"alice\", \"created_at\": \"2020-06-30T11:50:19.723504\"},\n  {\"name\": \"alice\", \"created_at\": \"2023-07-20T08:14:38.140312\"},\n  {\"name\": \"alice\", \"created_at\": \"2021-10-10T03:05:16.140258\"}\n]\n</code></pre>"},{"location":"guides/cli/#invalid-paths","title":"Invalid Paths","text":"<p>If the path is malformed or the module/attribute not found, the CLI exits with an error:</p> <pre><code>$ semblance export openapi missing:api\nInvalid path 'missing:api'. Use module:attr (e.g. app:api or app:app)\n# or\nModule 'missing' not found\n# or\nAttribute 'api' not found in module 'missing'\n</code></pre>"},{"location":"guides/getting-started/","title":"Getting Started","text":"<p>This guide walks you through creating your first Semblance API in under five minutes.</p>"},{"location":"guides/getting-started/#install","title":"Install","text":"<pre><code>pip install semblance\n</code></pre> <p>Requires Python 3.10+.</p>"},{"location":"guides/getting-started/#your-first-api","title":"Your First API","text":"<p>Create a file <code>app.py</code>:</p> <pre><code>from datetime import date, datetime\nfrom typing import Annotated\n\nfrom pydantic import BaseModel\nfrom semblance import DateRangeFrom, FromInput, SemblanceAPI\n\n\nclass UserQuery(BaseModel):\n    name: str = \"alice\"\n    start_date: date = date(2020, 1, 1)\n    end_date: date = date(2025, 12, 31)\n\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n    created_at: Annotated[\n        datetime,\n        DateRangeFrom(\"start_date\", \"end_date\"),\n    ]\n\n\napi = SemblanceAPI()\n\n\n@api.get(\"/users\", input=UserQuery, output=list[User])\ndef users():\n    pass\n\n\napp = api.as_fastapi()\n</code></pre>"},{"location":"guides/getting-started/#run-it","title":"Run It","text":"<pre><code>uvicorn app:app --reload\n</code></pre>"},{"location":"guides/getting-started/#try-it","title":"Try It","text":"<pre><code>curl \"http://127.0.0.1:8000/users?name=alice&amp;start_date=2024-01-01&amp;end_date=2024-12-31\"\n</code></pre> <p>Example response (with default list_count=5; shown with <code>list_count=2</code> for brevity):</p> <pre><code>[\n  {\"name\": \"alice\", \"created_at\": \"2024-08-21T09:22:43.516168\"},\n  {\"name\": \"alice\", \"created_at\": \"2024-01-10T03:05:39.176702\"}\n]\n</code></pre> <p>Output above is from <code>SemblanceAPI(seed=42)</code> and <code>list_count=2</code> for reproducibility. Each user's <code>name</code> comes from the query (<code>alice</code>), and <code>created_at</code> is a random datetime in the date range.</p>"},{"location":"guides/getting-started/#how-it-works","title":"How It Works","text":"<ol> <li>Input model (<code>UserQuery</code>) \u2013 validates the request (query params, body, or path).</li> <li>Output model (<code>User</code>) \u2013 defines the response shape.</li> <li>Links (<code>FromInput</code>, <code>DateRangeFrom</code>) \u2013 declare how output fields relate to input. No endpoint logic required.</li> </ol> <p>The handler body is empty; Semblance generates responses from your schemas.</p>"},{"location":"guides/getting-started/#next-steps","title":"Next Steps","text":"<ul> <li>Input and Output Binding \u2013 bind fields from input, date ranges, and more</li> <li>Testing \u2013 use the test client with pytest</li> </ul>"},{"location":"guides/input-output-binding/","title":"Input and Output Binding","text":"<p>This guide covers how to bind output fields to request input using Semblance links.</p>"},{"location":"guides/input-output-binding/#frominput","title":"FromInput","text":"<p>Bind an output field to an input field by name:</p> <pre><code>from typing import Annotated\nfrom semblance import FromInput\n\nclass User(BaseModel):\n    name: Annotated[str, FromInput(\"name\")]\n</code></pre> <p>When the input has <code>name=\"alice\"</code>, the response will have <code>name: \"alice\"</code>. If the input field is missing or <code>None</code>, Polyfactory generates a value instead.</p> <p>Example (with <code>GET /user?name=alice</code>):</p> <pre><code>{\"name\": \"alice\"}\n</code></pre>"},{"location":"guides/input-output-binding/#daterangefrom","title":"DateRangeFrom","text":"<p>Generate a <code>datetime</code> within a range defined by two input date fields:</p> <pre><code>from datetime import datetime\nfrom typing import Annotated\nfrom semblance import DateRangeFrom\n\nclass User(BaseModel):\n    created_at: Annotated[\n        datetime,\n        DateRangeFrom(\"start_date\", \"end_date\"),\n    ]\n</code></pre> <p>If <code>start_date</code> and <code>end_date</code> are present on the input, <code>created_at</code> is a random datetime in that range. When <code>end &lt;= start</code>, the result is <code>start</code>.</p>"},{"location":"guides/input-output-binding/#input-sources","title":"Input Sources","text":""},{"location":"guides/input-output-binding/#query-parameters-get","title":"Query Parameters (GET)","text":"<pre><code>@api.get(\"/users\", input=UserQuery, output=list[User])\ndef users():\n    pass\n</code></pre> <p><code>UserQuery</code> is validated from the query string.</p>"},{"location":"guides/input-output-binding/#request-body-post","title":"Request Body (POST)","text":"<pre><code>@api.post(\"/users\", input=CreateUserRequest, output=User)\ndef create_user():\n    pass\n</code></pre> <p><code>CreateUserRequest</code> is validated from the JSON body.</p>"},{"location":"guides/input-output-binding/#path-parameters","title":"Path Parameters","text":"<pre><code>class UserGetInput(BaseModel):\n    id: str = \"\"   # default required for query validation\n    name: str = \"alice\"\n\n@api.get(\"/users/{id}\", input=UserGetInput, output=User)\ndef get_user():\n    pass\n</code></pre> <p>Path params (e.g. <code>id</code> from <code>/users/123</code>) are merged into the validated input. Your input model must include path param names with defaults.</p>"},{"location":"guides/input-output-binding/#output-types","title":"Output Types","text":"<ul> <li>Single model: <code>output=User</code> \u2013 one instance</li> <li>List: <code>output=list[User]</code> \u2013 list of instances (default 5, configurable)</li> <li>Paginated: <code>output=PaginatedResponse[User]</code> \u2013 see Pagination</li> </ul>"},{"location":"guides/input-output-binding/#list_count","title":"list_count","text":"<p>Control list length:</p> <pre><code># Fixed count\n@api.get(\"/users\", input=UserQuery, output=list[User], list_count=10)\ndef users():\n    pass\n\n# From input field\n@api.get(\"/users\", input=UserQueryWithLimit, output=list[User], list_count=\"limit\")\ndef users():\n    pass\n</code></pre>"},{"location":"guides/pagination/","title":"Pagination","text":"<p>Semblance provides helpers for offset/limit pagination.</p>"},{"location":"guides/pagination/#pageparams","title":"PageParams","text":"<p>Use <code>PageParams</code> as a base for your input model to get <code>limit</code> and <code>offset</code>:</p> <pre><code>from semblance import PageParams, PaginatedResponse\n\nclass UserListQuery(PageParams, BaseModel):\n    name: str = \"alice\"\n</code></pre> <p><code>PageParams</code> adds <code>limit: int = 10</code> and <code>offset: int = 0</code>.</p>"},{"location":"guides/pagination/#paginatedresponse","title":"PaginatedResponse","text":"<p>Use <code>PaginatedResponse[Model]</code> as the output type:</p> <pre><code>@api.get(\"/users\", input=UserListQuery, output=PaginatedResponse[User])\ndef users():\n    pass\n</code></pre>"},{"location":"guides/pagination/#response-shape","title":"Response Shape","text":"<p>Responses include <code>items</code>, <code>total</code>, <code>limit</code>, and <code>offset</code>:</p> <pre><code>{\n  \"items\": [\n    {\"name\": \"alice\"},\n    {\"name\": \"alice\"},\n    {\"name\": \"alice\"}\n  ],\n  \"total\": 3,\n  \"limit\": 3,\n  \"offset\": 0\n}\n</code></pre>"},{"location":"guides/pagination/#example-request","title":"Example Request","text":"<pre><code>curl \"http://127.0.0.1:8000/users?name=alice&amp;limit=5&amp;offset=10\"\n</code></pre>"},{"location":"guides/pagination/#notes","title":"Notes","text":"<ul> <li><code>total</code> reflects the simulated total for the current page window.</li> <li>In stateless mode, each request generates fresh data. Use <code>SemblanceAPI(stateful=True)</code> if you need persistent collections.</li> </ul>"},{"location":"guides/plugins/","title":"Plugins","text":"<p>Register custom link types to extend Semblance's binding behavior.</p>"},{"location":"guides/plugins/#register-a-link","title":"Register a Link","text":"<p>Implement a class with a <code>resolve(input_data: dict, rng)</code> method and register it:</p> <pre><code>from semblance import register_link, SemblanceAPI\n\nclass FromEnv:\n    def __init__(self, env_var: str):\n        self.env_var = env_var\n\n    def resolve(self, input_data: dict, rng) -&gt; str | None:\n        import os\n        return os.environ.get(self.env_var)\n\nregister_link(FromEnv)\n</code></pre> <p>Then use it in output models:</p> <pre><code>from typing import Annotated\nfrom pydantic import BaseModel\n\nclass User(BaseModel):\n    name: Annotated[str, FromEnv(\"USER_NAME\")]\n</code></pre>"},{"location":"guides/plugins/#resolve-signature","title":"Resolve Signature","text":"<ul> <li><code>input_data</code> \u2013 validated input as a dict (from <code>model_dump()</code>)</li> <li><code>rng</code> \u2013 <code>random.Random</code> instance (seeded when <code>SemblanceAPI(seed=...)</code> or <code>seed_from</code> is used)</li> <li>Return value is used as the field value; return <code>None</code> to let Polyfactory generate</li> </ul>"},{"location":"guides/plugins/#example-randomchoice","title":"Example: RandomChoice","text":"<p>Pick a value from an input list:</p> <pre><code>class RandomChoice:\n    def __init__(self, field: str):\n        self.field = field\n\n    def resolve(self, input_data: dict, rng) -&gt; str | None:\n        opts = input_data.get(self.field)\n        if opts and isinstance(opts, (list, tuple)):\n            return rng.choice(opts)\n        return None\n\nregister_link(RandomChoice)\n\nclass Item(BaseModel):\n    choice: Annotated[str, RandomChoice(\"options\")]\n\nclass QueryWithOptions(BaseModel):\n    options: list[str] = [\"a\", \"b\", \"c\"]\n</code></pre> <p>Example output (<code>GET /item?options=a&amp;options=b&amp;options=c</code> with seed=42):</p> <pre><code>{\"choice\": \"c\"}\n</code></pre>"},{"location":"guides/plugins/#check-registration","title":"Check Registration","text":"<pre><code>from semblance.plugins import get_registered_links, is_registered\n\nregister_link(FromEnv)\nassert FromEnv in get_registered_links()\nassert is_registered(FromEnv(\"X\"))\n</code></pre>"},{"location":"guides/simulation-options/","title":"Simulation Options","text":"<p>Semblance lets you simulate realistic API behavior: errors, latency, and filtering.</p>"},{"location":"guides/simulation-options/#error-simulation","title":"Error Simulation","text":"<p>Simulate random failures:</p> <pre><code>@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=list[User],\n    error_rate=0.1,\n    error_codes=[404, 500],\n)\ndef users():\n    pass\n</code></pre> <ul> <li><code>error_rate=0.1</code> \u2013 10% of requests raise an error.</li> <li><code>error_codes=[404, 500]</code> \u2013 which status codes to return (default <code>[404, 500]</code>).</li> <li>Use <code>error_rate=0</code> for normal behavior; use <code>error_rate=1.0</code> to always fail (useful for tests).</li> </ul>"},{"location":"guides/simulation-options/#latency-and-jitter","title":"Latency and Jitter","text":"<p>Add simulated network delay:</p> <pre><code>@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=list[User],\n    latency_ms=100,\n    jitter_ms=20,\n)\ndef users():\n    pass\n</code></pre> <p>Actual delay is <code>latency_ms \u00b1 jitter_ms</code> milliseconds. Use for load testing or UX simulation.</p>"},{"location":"guides/simulation-options/#collection-filtering","title":"Collection Filtering","text":"<p>Filter list items by matching an input field:</p> <pre><code>@api.get(\n    \"/users\",\n    input=UserQueryWithStatus,\n    output=list[UserWithStatus],\n    filter_by=\"status\",\n)\ndef users():\n    pass\n</code></pre> <p>Only items whose <code>status</code> matches <code>input.status</code> are returned. Requires the output model to have a <code>status</code> field. Oversampling is used internally to approximate the requested list size.</p> <p>Example output (<code>GET /users?name=x&amp;status=active</code> with <code>list_count=3</code>, seed=1):</p> <pre><code>[\n  {\"name\": \"x\", \"status\": \"active\"},\n  {\"name\": \"x\", \"status\": \"active\"},\n  {\"name\": \"x\", \"status\": \"active\"}\n]\n</code></pre>"},{"location":"guides/simulation-options/#combining-options","title":"Combining Options","text":"<pre><code>@api.get(\n    \"/users\",\n    input=UserQuery,\n    output=list[User],\n    list_count=5,\n    seed_from=\"seed\",\n    error_rate=0.05,\n    error_codes=[503],\n    latency_ms=50,\n    jitter_ms=10,\n    filter_by=\"status\",\n)\ndef users():\n    pass\n</code></pre>"},{"location":"guides/stateful-mode/","title":"Stateful Mode","text":"<p>With <code>SemblanceAPI(stateful=True)</code>, POST endpoints store created instances and GET list endpoints return stored data.</p>"},{"location":"guides/stateful-mode/#enabling-stateful-mode","title":"Enabling Stateful Mode","text":"<pre><code>api = SemblanceAPI(stateful=True)\n</code></pre>"},{"location":"guides/stateful-mode/#behavior","title":"Behavior","text":"<ul> <li>POST \u2013 Builds the response as usual, stores it in memory, and returns it.</li> <li>GET list \u2013 Returns stored instances for that path instead of generating new ones.</li> </ul> <p>State is keyed by path (e.g. <code>/users</code>). It is process-local and not shared across workers.</p>"},{"location":"guides/stateful-mode/#example","title":"Example","text":"<pre><code>from typing import Annotated\nfrom semblance import FromInput, SemblanceAPI\n\nclass CreateUser(BaseModel):\n    name: str\n\nclass UserWithId(BaseModel):\n    id: str = \"\"\n    name: Annotated[str, FromInput(\"name\")]\n\napi = SemblanceAPI(stateful=True)\napi.post(\"/users\", input=CreateUser, output=UserWithId)(lambda: None)\napi.get(\"/users\", input=CreateUser, output=list[UserWithId])(lambda: None)\napp = api.as_fastapi()\n</code></pre> <pre><code># Create users\ncurl -X POST http://127.0.0.1:8000/users -H \"Content-Type: application/json\" -d '{\"name\":\"alice\"}'\ncurl -X POST http://127.0.0.1:8000/users -H \"Content-Type: application/json\" -d '{\"name\":\"bob\"}'\n\n# List returns stored users\ncurl http://127.0.0.1:8000/users\n</code></pre> <p>Example responses (IDs are auto-generated UUIDs):</p> <pre><code>// POST alice\n{\"id\": \"HbolMJUevblAbkHClEQa\", \"name\": \"alice\"}\n\n// POST bob\n{\"id\": \"PKriXrefSFPLBYtCRGSE\", \"name\": \"bob\"}\n\n// GET /users\n[\n  {\"id\": \"HbolMJUevblAbkHClEQa\", \"name\": \"alice\"},\n  {\"id\": \"PKriXrefSFPLBYtCRGSE\", \"name\": \"bob\"}\n]\n</code></pre>"},{"location":"guides/stateful-mode/#id-generation","title":"ID Generation","text":"<p>If the output model has an <code>id</code> field and it is empty or missing, Semblance assigns a UUID before storing.</p>"},{"location":"guides/stateful-mode/#clearing-state","title":"Clearing State","text":"<p>Use <code>clear_store()</code> for tests or resets:</p> <pre><code>api.clear_store()        # Clear all paths\napi.clear_store(\"/users\")  # Clear only /users\n</code></pre>"},{"location":"guides/stateful-mode/#limitations","title":"Limitations","text":"<ul> <li>State lives in process memory; it is lost on restart.</li> <li>Not suitable for multi-worker deployments; each worker has its own store.</li> <li>GET single-item endpoints (e.g. <code>/users/{id}</code>) still generate responses; only GET list endpoints read from the store.</li> </ul>"},{"location":"guides/testing/","title":"Testing","text":"<p>Semblance is built for testing. Use the test client with pytest for fast, deterministic API tests.</p>"},{"location":"guides/testing/#test_client","title":"test_client","text":"<pre><code>from semblance import SemblanceAPI, test_client\n\napi = SemblanceAPI()\n@api.get(\"/users\", input=UserQuery, output=list[User])(lambda: None)\napp = api.as_fastapi()\nclient = test_client(app)\n\nr = client.get(\"/users?name=testuser\")\nassert r.status_code == 200\ndata = r.json()\nassert all(u[\"name\"] == \"testuser\" for u in data)\n# data: [{\"name\": \"testuser\", \"created_at\": \"2024-08-21T09:22:43.516168\"}, ...]\n</code></pre> <p><code>test_client</code> wraps your FastAPI app in Starlette's <code>TestClient</code>. No server process is started.</p>"},{"location":"guides/testing/#deterministic-seeding","title":"Deterministic Seeding","text":"<p>Use a fixed seed for reproducible tests:</p> <pre><code>api = SemblanceAPI(seed=42)\n</code></pre> <p>Or per-request via <code>seed_from</code>:</p> <pre><code>class UserQueryWithSeed(BaseModel):\n    name: str = \"alice\"\n    seed: int | None = None\n\n@api.get(\"/users\", input=UserQueryWithSeed, output=list[User], seed_from=\"seed\")\ndef users():\n    pass\n\n# Same seed \u2192 same responses\nr1 = client.get(\"/users?name=x&amp;seed=99\")\nr2 = client.get(\"/users?name=x&amp;seed=99\")\nassert r1.json()[0][\"created_at\"] == r2.json()[0][\"created_at\"]\n</code></pre>"},{"location":"guides/testing/#pytest-fixture","title":"Pytest Fixture","text":"<pre><code># conftest.py\nimport pytest\nfrom semblance import SemblanceAPI, test_client\n\n@pytest.fixture\ndef api():\n    api = SemblanceAPI(seed=42)\n    api.get(\"/users\", input=UserQuery, output=list[User])(lambda: None)\n    return api\n\n@pytest.fixture\ndef client(api):\n    return test_client(api.as_fastapi())\n\n# test_users.py\ndef test_users_return_list(client):\n    r = client.get(\"/users?name=alice\")\n    assert r.status_code == 200\n    assert isinstance(r.json(), list)\n</code></pre>"},{"location":"guides/testing/#contract-and-snapshot-testing","title":"Contract and Snapshot Testing","text":"<ul> <li>Assert response shape matches your output model.</li> <li>Use deterministic seeds for snapshot-style checks.</li> <li>Test validation: send invalid input and assert <code>422</code> responses.</li> </ul>"}]}